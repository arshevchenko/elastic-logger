version: '3'
services:
    elasticsearch:
        image: elasticsearch:5.4.0-alpine
        ports:
            - "9200:9200"
            - "9300:9300"
        networks:
            - elk
        environment:
            ES_JAVA_OPTS: "-Xms1g -Xmx1g"

    logstash:
        build: ./images/logstash/
        depends_on:
            - elasticsearch 
        volumes:
            - "${HOST_PATH}:/opt/"
            - "${PWD}/images/logstash/pipeline/:/usr/share/logstash/pipeline/"
            - "${PWD}/images/logstash/config/logstash.yml:/usr/share/logstash/config/logstash.yml"
        environment:
            ES_JAVA_OPTS: "-Xms1g -Xmx1g"
        networks:
            - elk

    kibana-ui:
        image: kibana:latest
        depends_on: 
            - elasticsearch
        ports: 
            - "80:5601"
            - "8080:5601"
        networks:
            - elk

networks:
  elk:
    driver: bridge
